services:
  api:
    build: ./packages/api
    env_file:
      - ./packages/api/.env
    environment:
      - STORE_BIN=/app/store-cli
      - STORE_DB_DIR=/data/pdfdb
      - PDF_MAX_MB=100
      - RATE_LIMIT_MAX=200
    ports:
      - "3000:3000"
    volumes:
      - pdfdb:/data/pdfdb
    depends_on:
      - ipfs
  ipfs:
    image: ipfs/kubo:latest
    ports:
      - "5001:5001"
      - "8080:8080"
    volumes:
      - ipfs_staging:/export
      - ipfs_data:/data/ipfs
volumes:
  pdfdb:
  ipfs_staging:
  ipfs_data:
